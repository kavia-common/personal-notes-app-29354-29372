{"is_source_file": true, "format": "TypeScript", "description": "This file defines the NotesService class for managing notes in a frontend Angular application. It handles CRUD operations, in-memory state management synchronized with localStorage, case-insensitive search, deterministic ID generation, and seed data initialization.", "external_files": ["../models/note.model", "./storage.service"], "external_methods": [], "published": ["NotesService"], "classes": [{"name": "NotesService", "description": "Angular injectable service managing the lifecycle, storage, and search/filtering of notes."}], "methods": [{"name": "listNotes(query?: string): Note[] { listNotes", "description": "Returns a list of notes, optionally filtered by a case-insensitive search query across title, content, and tags.", "scope": "NotesService", "scopeKind": "class"}, {"name": "getNote(id: string): Note | undefined { getNote", "description": "Retrieves a note by its ID, or undefined if not found.", "scope": "NotesService", "scopeKind": "class"}, {"name": "createNote(payload: { title: string; content?: string; tags?: string[] }): Note { createNote", "description": "Creates a new note with a deterministic ID and current timestamps, adds it to the notes list, and persists storage.", "scope": "NotesService", "scopeKind": "class"}, {"name": "updateNote(note: Note): Note { updateNote", "description": "Updates an existing note by ID, updates timestamps, and persists changes.", "scope": "NotesService", "scopeKind": "class"}, {"name": "deleteNote(id: string): void { deleteNote", "description": "Deletes a note by ID, if it exists, and updates storage.", "scope": "NotesService", "scopeKind": "class"}, {"name": "constructor(private storage: StorageService) { constructor", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private generateId(): string { generateId", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private persist(): void { persist", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private sanitizeNotes(items: unknown): Note[] { sanitizeNotes", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private seedNotes(): Note[] { seedNotes", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private sortDescByUpdatedAt(list: Note[]): Note[] { sortDescByUpdatedAt", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}], "calls": ["this.storage.read", "this.storage.write", "this.sortDescByUpdatedAt", "this.sanitizeNotes", "this.seedNotes", "this.generateId"], "search-terms": ["NotesService", "CRUD notes", "localStorage sync", "case-insensitive search", "seed data", "deterministic ID"], "state": 2, "file_id": 23, "knowledge_revision": 76, "git_revision": "5d9c4b2c7d42edaeb85c6f146d7976bed4d0aebb", "revision_history": [{"47": ""}, {"76": "5d9c4b2c7d42edaeb85c6f146d7976bed4d0aebb"}], "ctags": [{"_type": "tag", "name": "NotesService", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^export class NotesService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const before = this.notes.length;$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.deleteNote", "scopeKind": "method"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  constructor(private storage: StorageService) {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "createNote", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  createNote(payload: { title: string; content?: string; tags?: string[] }): Note {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "deleteNote", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  deleteNote(id: string): void {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "generateId", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private generateId(): string {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "getNote", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  getNote(id: string): Note | undefined {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      ...this.notes[idx],$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.updateNote", "scopeKind": "method"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const idx = this.notes.findIndex((n) => n.id === note.id);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.updateNote", "scopeKind": "method"}, {"_type": "tag", "name": "inContent", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      const inContent = (n.content ?? '').toLowerCase().includes(q);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.listNotes", "scopeKind": "method"}, {"_type": "tag", "name": "inTags", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      const inTags = Array.isArray(n.tags) && n.tags.some((t) => (t ?? '').toLowerCase().include/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.listNotes", "scopeKind": "method"}, {"_type": "tag", "name": "inTitle", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      const inTitle = (n.title ?? '').toLowerCase().includes(q);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.listNotes", "scopeKind": "method"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const list = this.sortDescByUpdatedAt([...this.notes]);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.listNotes", "scopeKind": "method"}, {"_type": "tag", "name": "listNotes", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  listNotes(query?: string): Note[] {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^        const n = x as Partial<Note>;$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.sanitizeNotes", "scopeKind": "method"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const note: Note = {$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.createNote", "scopeKind": "method"}, {"_type": "tag", "name": "note1Time", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const note1Time = new Date(now.getTime() - 1000 * 60 * 60).toISOString();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.seedNotes", "scopeKind": "method"}, {"_type": "tag", "name": "note2Time", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const note2Time = new Date(now.getTime() - 1000 * 60 * 10).toISOString();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.seedNotes", "scopeKind": "method"}, {"_type": "tag", "name": "notes", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private notes: Note[] = [];$/", "language": "TypeScript", "kind": "property", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const now = new Date().toISOString();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.createNote", "scopeKind": "method"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const now = new Date().toISOString();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.updateNote", "scopeKind": "method"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const now = new Date();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.seedNotes", "scopeKind": "method"}, {"_type": "tag", "name": "persist", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private persist(): void {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "q", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const q = query.toLowerCase().trim();$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.listNotes", "scopeKind": "method"}, {"_type": "tag", "name": "sample", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const sample: Note[] = [$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.seedNotes", "scopeKind": "method"}, {"_type": "tag", "name": "sanitizeNotes", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private sanitizeNotes(items: unknown): Note[] {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "seedNotes", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private seedNotes(): Note[] {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "sortDescByUpdatedAt", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private sortDescByUpdatedAt(list: Note[]): Note[] {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "storage", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  constructor(private storage: StorageService) {$/", "language": "TypeScript", "kind": "property", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "storageKey", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  private readonly storageKey = StorageService.NOTES_KEY;$/", "language": "TypeScript", "kind": "property", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "stored", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const stored = this.storage.read<Note[]>(this.storageKey);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.constructor", "scopeKind": "method"}, {"_type": "tag", "name": "ta", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      const ta = Date.parse((a.updatedAt || a.createdAt || '') as string);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.sortDescByUpdatedAt", "scopeKind": "method"}, {"_type": "tag", "name": "tb", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      const tb = Date.parse((b.updatedAt || b.createdAt || '') as string);$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.sortDescByUpdatedAt", "scopeKind": "method"}, {"_type": "tag", "name": "updateNote", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^  updateNote(note: Note): Note {$/", "language": "TypeScript", "kind": "method", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^    const updated: Note = {$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.updateNote", "scopeKind": "method"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/personal-notes-app-29354-29372/notes_frontend/src/app/services/notes.service.ts", "pattern": "/^      updatedAt: now,$/", "language": "TypeScript", "kind": "constant", "scope": "NotesService.updateNote", "scopeKind": "method"}], "hash": "c79731bb285a7a485cedc7ec9ee17582", "format-version": 4, "code-base-name": "notes_frontend", "filename": "notes_frontend/src/app/services/notes.service.ts", "fields": [{"name": "private notes: Note[] = [];", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "constructor(private storage: StorageService) {", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly storageKey = StorageService.NOTES_KEY;", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}]}