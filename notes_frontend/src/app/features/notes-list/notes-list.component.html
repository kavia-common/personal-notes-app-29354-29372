<section class="notes-list-wrap" role="navigation" aria-label="Notes navigation">
  <div class="search">
    <label class="sr-only" for="sidebar-search">Search notes</label>
    <input
      id="sidebar-search"
      type="search"
      [value]="query()"
      (input)="onInput($event)"
      (keydown)="onSearchKeydown($event)"
      placeholder="Search notes..."
      aria-label="Search notes"
      autocomplete="off"
    />
  </div>

  <button class="btn-primary" type="button" (click)="createNote()" aria-label="Create a new note">
    + New Note
  </button>

  <div class="sr-only" aria-live="polite">{{ statusMessage() }}</div>

  <ng-container *ngIf="filteredNotes$ | async as notes">
    <ul
      class="notes-ul"
      *ngIf="notes.length; else emptyState"
      role="list"
      [attr.aria-label]="listAriaLabel"
    >
      <li
        class="note-item"
        *ngFor="let n of notes; let i = index"
        (click)="openNote(n)"
        (keydown)="onItemKeydown($event, i, notes)"
        tabindex="0"
        [class.active]="isActive(n)"
        [attr.aria-current]="isActive(n) ? 'page' : null"
        role="listitem"
        [attr.aria-label]="(n.title || '(Untitled)') + ', updated ' + (n.updatedAt | date:'medium')"
      >
        <div class="note-title" [title]="n.title">{{ n.title || '(Untitled)' }}</div>
        <div class="note-meta">
          <span class="updated">Updated {{ n.updatedAt | date:'medium' }}</span>
          <span class="tags" *ngIf="tags(n) as tagStr" [title]="tagStr">{{ tagStr }}</span>
        </div>
        <div class="note-snippet" *ngIf="snippet(n) as s">{{ s }}</div>
      </li>
    </ul>

    <ng-template #emptyState>
      <div class="empty" role="status" aria-live="polite">
        <p>No notes found.</p>
        <p class="muted">Try a different search or create a new note.</p>
      </div>
    </ng-template>
  </ng-container>
</section>
